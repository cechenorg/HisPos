<UserControl x:Class="His_Pos.SYSTEM_TAB.H4_BASIC_MANAGE.CustomerManage.CustomerManageView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
             xmlns:hisPos="clr-namespace:His_Pos"
             xmlns:local="clr-namespace:His_Pos.SYSTEM_TAB.H4_BASIC_MANAGE.CustomerManage"
             xmlns:xctk="http://schemas.xceed.com/wpf/xaml/toolkit"
             xmlns:command="http://www.galasoft.ch/mvvmlight"
             xmlns:service="clr-namespace:His_Pos.Service"
             mc:Ignorable="d"  
             xmlns:i="clr-namespace:System.Windows.Interactivity;assembly=System.Windows.Interactivity">
    <UserControl.Resources>
        <service:NullableDateConverter x:Key="NullableDateConverter" /> 
        <DataTemplate x:Key="CustomerManageViewModel" DataType="{x:Type local:CustomerManageViewModel}">
            <local:CustomerManageView/>
        </DataTemplate>
    </UserControl.Resources>
    <UserControl.DataContext>
        <local:CustomerManageViewModel/>
    </UserControl.DataContext>
    <Grid Width="1365" Height="869">
        <Grid.RowDefinitions>
            <RowDefinition Height="50"/>
            <RowDefinition/>
        </Grid.RowDefinitions>
        <StackPanel Orientation="Horizontal" Grid.Row="0">
            <Label Content="姓名" Margin="10,0,0,0" HorizontalAlignment="Center" Height="50" VerticalContentAlignment="Center" Foreground="Black" FontSize="20" FontFamily="Segoe UI Semibold"/>
            <TextBox Text="{Binding TextCusName,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}"  Margin="10,0,0,8" Width="120" FontSize="18" FontFamily="Segoe UI Semi"/>
            <Label Content="生日" Margin="10,0,0,0" HorizontalAlignment="Center" Height="50" VerticalContentAlignment="Center" Foreground="Black" FontSize="20" FontFamily="Segoe UI Semibold"/>
            <xctk:MaskedTextBox Width="120" Height="35" Margin="5,0,5,0" HorizontalContentAlignment="Center"  FontSize="18" Style="{StaticResource MaterialDesignTextBox}"
                         Foreground="{StaticResource ForeGround}" Mask="000/00/00" PromptChar="-" ValueDataType="xctk:DateTimeFormat" InsertKeyMode="Overwrite"  >
                <xctk:MaskedTextBox.Text>
                    <Binding Path="TextCusBirthDay" Mode="TwoWay" UpdateSourceTrigger="PropertyChanged"
                                 ValidatesOnDataErrors="True" NotifyOnValidationError="True" Converter="{StaticResource NullableDateConverter}">
                        <Binding.ValidationRules>
                            <service:NullDateValidationRule/>
                        </Binding.ValidationRules>
                    </Binding>
                </xctk:MaskedTextBox.Text>
            </xctk:MaskedTextBox>
            <Label Content="身分證" Margin="10,0,0,0" HorizontalAlignment="Center" Height="50" VerticalContentAlignment="Center" Foreground="Black" FontSize="20" FontFamily="Segoe UI Semibold"/>
            <TextBox Text="1257"  Margin="10,0,0,8" Width="120" FontSize="18" FontFamily="Segoe UI Semi"/>
            <Button Command="{Binding ClearCommand}" Margin="555,0,0,0" Width="100" Content="清除" FontFamily="Segoe UI Semibold" FontSize="16" Background="DimGray" BorderThickness="0"/>
            <Button Command="{Binding SearchCommand}" Margin="10,0,0,0" Width="100" Content="查詢" FontFamily="Segoe UI Semibold" FontSize="16" Background="RoyalBlue" BorderThickness="0"/>
        </StackPanel>
        <Grid Grid.Row="1">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="260"/>
                <ColumnDefinition/>
            </Grid.ColumnDefinitions>
            <DataGrid Grid.Row="0" HeadersVisibility="None" HorizontalScrollBarVisibility="Hidden" Background="{StaticResource GridBackGround}" Margin="10,0,0,10" CanUserDeleteRows="False" CellStyle="{StaticResource DataGridCellStyle}"
                      ItemsSource="{Binding CustomerCollection,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}" SelectedItem="{Binding Customer,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}" ColumnHeaderStyle="{StaticResource DataGridColumnHeaderStyle}" AutoGenerateColumns="False" VerticalScrollBarVisibility="Hidden" CanUserAddRows="False">
                <DataGrid.RowStyle>
                    <Style TargetType="{x:Type DataGridRow}">
                        <Style.Triggers>
                            <Trigger Property="DataGridRow.IsSelected" Value="True">
                                <Setter Property="Background" Value="{StaticResource GridSelected}"/>
                            </Trigger>
                        </Style.Triggers>
                        <Setter Property="Background" Value="Transparent"/>
                        <Setter Property="BorderBrush" Value="Transparent"/>
                        <Setter Property="Height" Value="50"/>
                    </Style>
                </DataGrid.RowStyle>
                <DataGrid.Columns>
                    <DataGridTemplateColumn Width="250">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <StackPanel Orientation="Horizontal" Height="50">
                                    <Label Content="{Binding Name,UpdateSourceTrigger=PropertyChanged}" Width="130" Foreground="Black" FontFamily="Segoe UI Semibold" FontSize="25" VerticalAlignment="Center" Margin="10,0,0,0"/>
                                    <Label Content="{Binding Birthday,UpdateSourceTrigger=PropertyChanged, Converter={StaticResource NullableDateConverter}}" Foreground="Black"  FontSize="18" VerticalAlignment="Center"/>
                                </StackPanel>
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>
                </DataGrid.Columns>
                <i:Interaction.Triggers>
                    <i:EventTrigger EventName="SelectionChanged">
                        <i:InvokeCommandAction Command="{Binding SelectionChangedCommand}"/>
                    </i:EventTrigger>
                </i:Interaction.Triggers>
            </DataGrid>
            
        </Grid>
    </Grid>
</UserControl>

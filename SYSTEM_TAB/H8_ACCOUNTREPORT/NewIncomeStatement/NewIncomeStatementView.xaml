<UserControl x:Class="His_Pos.SYSTEM_TAB.H8_ACCOUNTREPORT.NewIncomeStatement.NewIncomeStatementView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:i="http://schemas.microsoft.com/expression/2010/interactivity"
             xmlns:local="clr-namespace:His_Pos.SYSTEM_TAB.H8_ACCOUNTREPORT.NewIncomeStatement" 
             xmlns:command="http://www.galasoft.ch/mvvmlight"
             xmlns:xctk="http://schemas.xceed.com/wpf/xaml/toolkit"
             mc:Ignorable="d"
             d:DesignHeight="450" d:DesignWidth="1365">
    <i:Interaction.Triggers >
        <i:EventTrigger EventName="Loaded">
            <command:EventToCommand Command="{Binding ReloadCommand}"/>
        </i:EventTrigger>
    </i:Interaction.Triggers>
    <UserControl.Resources>
        <DataTemplate x:Key="expanderHeader">
            <TextBlock Text="{Binding}" FontFamily="Segoe UI Semibold" FontSize="24" TextWrapping="Wrap"/>
        </DataTemplate>
        <Style x:Key="columnHeader" TargetType="DataGridColumnHeader" BasedOn="{StaticResource {x:Type DataGridColumnHeader}}">
            <Setter Property="FontFamily" Value="Segoe UI Semibold"/>
            <Setter Property="FontSize" Value="18"/>
            <Setter Property="HorizontalAlignment" Value="Right"/>
        </Style>
        <Style x:Key="row" TargetType="DataGridRow" BasedOn="{StaticResource {x:Type DataGridRow}}">
            <Setter Property="FontFamily" Value="Segoe UI Semibold"/>
            <Setter Property="FontSize" Value="16"/>
        </Style>
        <Style x:Key="cell" TargetType="DataGridCell" BasedOn="{StaticResource {x:Type DataGridCell}}">
            <Setter Property="Padding" Value="0,8,5,8" />
            <Setter Property="HorizontalAlignment" Value="Right" />
            <Style.Triggers>
                <Trigger Property="IsSelected" Value="True">
                    <Setter Property="Background" Value="{x:Null}" />
                    <Setter Property="BorderBrush" Value="{x:Null}" />
                </Trigger>
            </Style.Triggers>
        </Style>
        <Style x:Key="totalTextBlock" TargetType="TextBlock" BasedOn="{StaticResource {x:Type TextBlock}}">
            <Setter Property="Width" Value="100" />
            <Setter Property="HorizontalAlignment" Value="Right" />
        </Style>
        <Style x:Key="totalCell" TargetType="DataGridCell" BasedOn="{StaticResource {x:Type DataGridCell}}">
            <Setter Property="Padding" Value="0,8,5,8" />
            <Setter Property="TextBlock.TextAlignment" Value="Right" />
            <Setter Property="Background" Value="Khaki"></Setter>
            <Style.Triggers>
                <Trigger Property="IsSelected" Value="True">
                    <Setter Property="Background" Value="Khaki" />
                    <Setter Property="BorderBrush" Value="{x:Null}" />
                </Trigger>
            </Style.Triggers>
        </Style>
    </UserControl.Resources>
    <xctk:BusyIndicator x:Name="bi">
        <ScrollViewer x:Name="scrollviewer">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="60"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="20"/>
                </Grid.RowDefinitions>
                <StackPanel Grid.Row="0" Orientation="Horizontal">
                    <Label Content="查詢年份" Margin="20,0,0,0" Height="60" FontFamily="Segoe UI Semibold" FontSize="20" VerticalContentAlignment="Center"></Label>
                    <Button x:Name="btnLeft" Width="30" Padding="0" Background="Transparent" BorderThickness="0" Click="btnLeft_Click">
                        <Image Source="/Images/left.png" Height="16"></Image>
                    </Button>
                    <TextBox x:Name="tbYear" Margin="0,0,0,0" Width="100" HorizontalContentAlignment="Center" VerticalAlignment="Center" FontFamily="Segoe UI Semi" FontSize="16" Foreground="Black" GotFocus="tbYear_GotFocus" PreviewKeyDown="tbYear_PreviewKeyDown">
                        <TextBox.InputScope>
                            <InputScope>
                                <InputScope.Names>
                                    <InputScopeName NameValue="AlphanumericHalfWidth"/>
                                </InputScope.Names>
                            </InputScope>
                        </TextBox.InputScope>
                    </TextBox>
                    <Button x:Name="btnRight" Width="30" Padding="0" Background="Transparent" BorderThickness="0" Click="btnRight_Click">
                        <Image Source="/Images/right.png" Height="16"></Image>
                    </Button>
                    <Button Content="重新整理" Margin="10,0,0,0" FontFamily="Segoe UI Semibold" FontSize="17" BorderThickness="0" Background="RoyalBlue" Click="Button_Click">
                    </Button>
                </StackPanel>
                <Expander Grid.Row="1" Margin="0,0,0,0" HorizontalAlignment="Stretch" Header="總覽" HeaderTemplate="{StaticResource expanderHeader}" Background="{x:Null}" IsExpanded="True">
                    <StackPanel Orientation="Vertical" Margin="24,0,24,0">
                        <DataGrid x:Name="dgTotal" CanUserDeleteRows="False" CanUserSortColumns="False" CanUserReorderColumns="False" CanUserResizeColumns="False" CanUserAddRows="False" IsReadOnly="True" AutoGenerateColumns="False"  ColumnHeaderStyle="{StaticResource columnHeader}" RowStyle="{StaticResource row}" CellStyle="{StaticResource cell}" SelectionUnit="Cell" PreviewMouseWheel="dg_PreviewMouseWheel">
                            <DataGrid.Columns>
                                <DataGridTextColumn Width="160" Header="" Binding="{Binding Path=MONTH}" />
                                <DataGridTextColumn Width="85" Header="1月" Binding="{Binding Path=JAN, StringFormat=N0}" />
                                <DataGridTextColumn Width="85" Header="2月" Binding="{Binding Path=FEB, StringFormat=N0}" />
                                <DataGridTextColumn Width="85" Header="3月" Binding="{Binding Path=MAR, StringFormat=N0}" />
                                <DataGridTextColumn Width="85" Header="4月" Binding="{Binding Path=APR, StringFormat=N0}" />
                                <DataGridTextColumn Width="85" Header="5月" Binding="{Binding Path=MAY, StringFormat=N0}" />
                                <DataGridTextColumn Width="85" Header="6月" Binding="{Binding Path=JUN, StringFormat=N0}" />
                                <DataGridTextColumn Width="85" Header="7月" Binding="{Binding Path=JUL, StringFormat=N0}" />
                                <DataGridTextColumn Width="85" Header="8月" Binding="{Binding Path=AUG, StringFormat=N0}" />
                                <DataGridTextColumn Width="85" Header="9月" Binding="{Binding Path=SEP, StringFormat=N0}" />
                                <DataGridTextColumn Width="85" Header="10月" Binding="{Binding Path=OCT, StringFormat=N0}" />
                                <DataGridTextColumn Width="85" Header="11月" Binding="{Binding Path=NOV, StringFormat=N0}" />
                                <DataGridTextColumn Width="85" Header="12月" Binding="{Binding Path=DEC, StringFormat=N0}" />
                                <DataGridTextColumn Width="*" Header="總計" Binding="{Binding Path=TOTAL, StringFormat=N0}" ElementStyle="{StaticResource totalTextBlock}" CellStyle="{StaticResource totalCell}" />
                            </DataGrid.Columns>
                        </DataGrid>
                    </StackPanel>
                </Expander>
                <Expander Grid.Row="2" Margin="0,20,0,0" HorizontalAlignment="Stretch" Header="營業毛利" HeaderTemplate="{StaticResource expanderHeader}" Background="{x:Null}" FontSize="20">
                    <StackPanel Orientation="Vertical" Margin="24,0,24,0">
                        <DataGrid x:Name="dgIncome" CanUserDeleteRows="False" CanUserSortColumns="False" CanUserReorderColumns="False" CanUserResizeColumns="False" CanUserAddRows="False" IsReadOnly="True" AutoGenerateColumns="False"  ColumnHeaderStyle="{StaticResource columnHeader}" RowStyle="{StaticResource row}" CellStyle="{StaticResource cell}" SelectionUnit="Cell" PreviewMouseWheel="dg_PreviewMouseWheel">
                            <DataGrid.Columns>
                                <DataGridTextColumn Width="160" Header="" Binding="{Binding Path=MONTH}" />
                                <DataGridTextColumn Width="85" Header="1月" Binding="{Binding Path=JAN, StringFormat=N0}" />
                                <DataGridTextColumn Width="85" Header="2月" Binding="{Binding Path=FEB, StringFormat=N0}" />
                                <DataGridTextColumn Width="85" Header="3月" Binding="{Binding Path=MAR, StringFormat=N0}" />
                                <DataGridTextColumn Width="85" Header="4月" Binding="{Binding Path=APR, StringFormat=N0}" />
                                <DataGridTextColumn Width="85" Header="5月" Binding="{Binding Path=MAY, StringFormat=N0}" />
                                <DataGridTextColumn Width="85" Header="6月" Binding="{Binding Path=JUN, StringFormat=N0}" />
                                <DataGridTextColumn Width="85" Header="7月" Binding="{Binding Path=JUL, StringFormat=N0}" />
                                <DataGridTextColumn Width="85" Header="8月" Binding="{Binding Path=AUG, StringFormat=N0}" />
                                <DataGridTextColumn Width="85" Header="9月" Binding="{Binding Path=SEP, StringFormat=N0}" />
                                <DataGridTextColumn Width="85" Header="10月" Binding="{Binding Path=OCT, StringFormat=N0}" />
                                <DataGridTextColumn Width="85" Header="11月" Binding="{Binding Path=NOV, StringFormat=N0}" />
                                <DataGridTextColumn Width="85" Header="12月" Binding="{Binding Path=DEC, StringFormat=N0}" />
                                <DataGridTextColumn Width="*" Header="總計" Binding="{Binding Path=TOTAL, StringFormat=N0}" ElementStyle="{StaticResource totalTextBlock}" CellStyle="{StaticResource totalCell}" />
                            </DataGrid.Columns>
                        </DataGrid>
                    </StackPanel>
                </Expander>
                <Expander Grid.Row="3" Margin="0,20,0,0" HorizontalAlignment="Stretch" Header="費用" HeaderTemplate="{StaticResource expanderHeader}" Background="{x:Null}">
                    <StackPanel Orientation="Vertical" Margin="24,0,24,0">
                        <DataGrid x:Name="dgExpanse" CanUserDeleteRows="False" CanUserSortColumns="False" CanUserReorderColumns="False" CanUserResizeColumns="False" CanUserAddRows="False" IsReadOnly="True" AutoGenerateColumns="False"  ColumnHeaderStyle="{StaticResource columnHeader}" RowStyle="{StaticResource row}" CellStyle="{StaticResource cell}" SelectionUnit="Cell" PreviewMouseWheel="dg_PreviewMouseWheel">
                            <DataGrid.Columns>
                                <DataGridTextColumn Width="160" Header="" Binding="{Binding Path=MONTH}" />
                                <DataGridTextColumn Width="85" Header="1月" Binding="{Binding Path=JAN, StringFormat=N0}" />
                                <DataGridTextColumn Width="85" Header="2月" Binding="{Binding Path=FEB, StringFormat=N0}" />
                                <DataGridTextColumn Width="85" Header="3月" Binding="{Binding Path=MAR, StringFormat=N0}" />
                                <DataGridTextColumn Width="85" Header="4月" Binding="{Binding Path=APR, StringFormat=N0}" />
                                <DataGridTextColumn Width="85" Header="5月" Binding="{Binding Path=MAY, StringFormat=N0}" />
                                <DataGridTextColumn Width="85" Header="6月" Binding="{Binding Path=JUN, StringFormat=N0}" />
                                <DataGridTextColumn Width="85" Header="7月" Binding="{Binding Path=JUL, StringFormat=N0}" />
                                <DataGridTextColumn Width="85" Header="8月" Binding="{Binding Path=AUG, StringFormat=N0}" />
                                <DataGridTextColumn Width="85" Header="9月" Binding="{Binding Path=SEP, StringFormat=N0}" />
                                <DataGridTextColumn Width="85" Header="10月" Binding="{Binding Path=OCT, StringFormat=N0}" />
                                <DataGridTextColumn Width="85" Header="11月" Binding="{Binding Path=NOV, StringFormat=N0}" />
                                <DataGridTextColumn Width="85" Header="12月" Binding="{Binding Path=DEC, StringFormat=N0}" />
                                <DataGridTextColumn Width="*" Header="總計" Binding="{Binding Path=TOTAL, StringFormat=N0}" ElementStyle="{StaticResource totalTextBlock}" CellStyle="{StaticResource totalCell}" />
                            </DataGrid.Columns>
                        </DataGrid>
                    </StackPanel>
                </Expander>
                <Expander Grid.Row="4" Margin="0,20,0,0" HorizontalAlignment="Stretch" Header="結案差額" HeaderTemplate="{StaticResource expanderHeader}" Background="{x:Null}">
                    <StackPanel Orientation="Vertical" Margin="24,0,24,0">
                        <DataGrid x:Name="dgDiff" CanUserDeleteRows="False" CanUserSortColumns="False" CanUserReorderColumns="False" CanUserResizeColumns="False" CanUserAddRows="False" IsReadOnly="True" AutoGenerateColumns="False"  ColumnHeaderStyle="{StaticResource columnHeader}" RowStyle="{StaticResource row}" CellStyle="{StaticResource cell}" SelectionUnit="Cell" PreviewMouseWheel="dg_PreviewMouseWheel">
                            <DataGrid.Columns>
                                <DataGridTextColumn Width="160" Header="" Binding="{Binding Path=MONTH}" />
                                <DataGridTextColumn Width="85" Header="1月" Binding="{Binding Path=JAN, StringFormat=N0}" />
                                <DataGridTextColumn Width="85" Header="2月" Binding="{Binding Path=FEB, StringFormat=N0}" />
                                <DataGridTextColumn Width="85" Header="3月" Binding="{Binding Path=MAR, StringFormat=N0}" />
                                <DataGridTextColumn Width="85" Header="4月" Binding="{Binding Path=APR, StringFormat=N0}" />
                                <DataGridTextColumn Width="85" Header="5月" Binding="{Binding Path=MAY, StringFormat=N0}" />
                                <DataGridTextColumn Width="85" Header="6月" Binding="{Binding Path=JUN, StringFormat=N0}" />
                                <DataGridTextColumn Width="85" Header="7月" Binding="{Binding Path=JUL, StringFormat=N0}" />
                                <DataGridTextColumn Width="85" Header="8月" Binding="{Binding Path=AUG, StringFormat=N0}" />
                                <DataGridTextColumn Width="85" Header="9月" Binding="{Binding Path=SEP, StringFormat=N0}" />
                                <DataGridTextColumn Width="85" Header="10月" Binding="{Binding Path=OCT, StringFormat=N0}" />
                                <DataGridTextColumn Width="85" Header="11月" Binding="{Binding Path=NOV, StringFormat=N0}" />
                                <DataGridTextColumn Width="85" Header="12月" Binding="{Binding Path=DEC, StringFormat=N0}" />
                                <DataGridTextColumn Width="*" Header="總計" Binding="{Binding Path=TOTAL, StringFormat=N0}" ElementStyle="{StaticResource totalTextBlock}" CellStyle="{StaticResource totalCell}" />
                            </DataGrid.Columns>
                        </DataGrid>
                    </StackPanel>
                </Expander>
                <Expander Grid.Row="5" Margin="0,20,0,0" HorizontalAlignment="Stretch" Header="處方張數" HeaderTemplate="{StaticResource expanderHeader}" Background="{x:Null}" >
                    <StackPanel Orientation="Vertical" Margin="24,0,24,0">
                        <DataGrid x:Name="dgPreCount" CanUserDeleteRows="False" CanUserSortColumns="False" CanUserReorderColumns="False" CanUserResizeColumns="False" CanUserAddRows="False" IsReadOnly="True" AutoGenerateColumns="False"  ColumnHeaderStyle="{StaticResource columnHeader}" RowStyle="{StaticResource row}" CellStyle="{StaticResource cell}" SelectionUnit="Cell" PreviewMouseWheel="dg_PreviewMouseWheel">
                            <DataGrid.Columns>
                                <DataGridTextColumn Width="160" Header="" Binding="{Binding Path=MONTH}" />
                                <DataGridTextColumn Width="85" Header="1月" Binding="{Binding Path=JAN, StringFormat=N0}" />
                                <DataGridTextColumn Width="85" Header="2月" Binding="{Binding Path=FEB, StringFormat=N0}" />
                                <DataGridTextColumn Width="85" Header="3月" Binding="{Binding Path=MAR, StringFormat=N0}" />
                                <DataGridTextColumn Width="85" Header="4月" Binding="{Binding Path=APR, StringFormat=N0}" />
                                <DataGridTextColumn Width="85" Header="5月" Binding="{Binding Path=MAY, StringFormat=N0}" />
                                <DataGridTextColumn Width="85" Header="6月" Binding="{Binding Path=JUN, StringFormat=N0}" />
                                <DataGridTextColumn Width="85" Header="7月" Binding="{Binding Path=JUL, StringFormat=N0}" />
                                <DataGridTextColumn Width="85" Header="8月" Binding="{Binding Path=AUG, StringFormat=N0}" />
                                <DataGridTextColumn Width="85" Header="9月" Binding="{Binding Path=SEP, StringFormat=N0}" />
                                <DataGridTextColumn Width="85" Header="10月" Binding="{Binding Path=OCT, StringFormat=N0}" />
                                <DataGridTextColumn Width="85" Header="11月" Binding="{Binding Path=NOV, StringFormat=N0}" />
                                <DataGridTextColumn Width="85" Header="12月" Binding="{Binding Path=DEC, StringFormat=N0}" />
                                <DataGridTextColumn Width="*" Header="總計" Binding="{Binding Path=TOTAL, StringFormat=N0}" ElementStyle="{StaticResource totalTextBlock}" CellStyle="{StaticResource totalCell}" />
                            </DataGrid.Columns>
                        </DataGrid>
                    </StackPanel>
                </Expander>
            </Grid>
        </ScrollViewer>
    </xctk:BusyIndicator>
</UserControl>
